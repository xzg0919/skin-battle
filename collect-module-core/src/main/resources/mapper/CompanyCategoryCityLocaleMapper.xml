<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tzj.collect.core.mapper.CompanyCategoryCityLocaleMapper" >



    <select id="getHouseHoldDetailLocale" parameterType="String" resultType="com.tzj.collect.core.result.business.CategoryResult">
        SELECT
            sc.name_,
            sc.id,
            scc.price,
            sc.unit
        FROM
            sb_category sc
        LEFT JOIN sb_company_category_city_locale scc ON scc.category_id = sc.id
        WHERE
            scc.`parent_id` = #{parentId}
        AND scc.`company_id` = #{companyId}
        AND scc.city_id = #{cityId}
    </select>
    <select id="getOneCategoryListLocale" resultType="com.tzj.collect.entity.Category" parameterType="Integer">
		SELECT DISTINCT
			scc.*
		FROM
			sb_category scc
		LEFT JOIN (SELECT sccc.id AS aId,sccc.price AS aprice,sccc.parent_id AS aparentId FROM sb_company_category_city_locale sccc WHERE sccc.company_id = #{companyId} AND sccc.city_id = #{cityId} ) sccc ON sccc.aparentId = scc.id
		LEFT JOIN (SELECT sc.id AS bId,sc.price AS bprice,sc.parent_id AS bparentId FROM sb_company_category sc WHERE sc.company_id = #{companyId} AND sc.del_flag = 0) sc ON sc.bparentId = scc.id
		WHERE
			scc.title = '2'
		AND scc.level_ = '0'
		AND(sccc.aId is not NULL OR sc.bId is NOT null)
	 </select>
    <select id="getTwoCategoryListLocale" parameterType="String" resultType="com.tzj.collect.core.result.ali.ComCatePrice">
		SELECT
			FORMAT(sccp.price,2) AS price,
			sccp.unit,
			sc.name_,
			sc.id,
			sc.icon
		FROM
			sb_company_category_city_locale sccp
		INNER JOIN sb_category sc ON sc.id = sccp.category_id
		WHERE
			sccp.parent_id = #{categoryId}
		AND sccp.company_id = #{companyId}
		AND sccp.del_flag = 0
		AND sc.del_flag = 0
		AND sccp.city_id = #{cityId}
		ORDER BY sc.code_ ASC
	</select>

</mapper>
