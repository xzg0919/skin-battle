<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tzj.collect.core.mapper.CompanyStreeMapper">

<select id="selectStreeCompanyIds" resultType="Integer" parameterType="Integer">
    SELECT DISTINCT
        a.company_id
        FROM
        sb_company_stree a
        LEFT JOIN sb_company_category b ON a.company_id = b.company_id
        WHERE
        a.stree_id = #{streetId}
    AND b.parent_id = #{categoryId}
    AND b.del_flag = 0
    AND a.del_flag = 0
</select>

    <select id="findCompanyCityName" resultType="string">
   SELECT  DISTINCT  e.area_name
        FROM
        sb_company_stree a
        LEFT JOIN sb_company_category b ON a.company_id = b.company_id
				inner join  sb_area c  on c.id = a.stree_id
				inner join sb_area d on d.id =c.parent_id
				inner join sb_area e on e.id =d.parent_id
				inner join  sb_area f on f.id =e.parent_id
       where a.company_id =#{companyId}
    AND b.parent_id =45
    AND b.del_flag = 0
    AND a.del_flag = 0
</select>

</mapper>
